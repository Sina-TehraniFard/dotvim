# 🧠 dotvim — VimをIDE化するための最小構成

## はじめに

最初から効率を求めてVimを使い始めたわけじゃない。  
正直、きっかけは単純だった。  

> ターミナルでコード書いてたら、なんかかっこよくね？  
> JetBrainsのサブスク高すぎじゃね？  
> あれ？Vimって行番号出せるんだ。  
> シンタックスハイライトも？じゃあ補完も？じゃあ定義ジャンプも？  

──そうして沼にハマっていった結果、  
設定がどんどん膨れ上がり、  
「もう自分専用の環境をきちんとリポジトリで管理しよう」と思い立った。

でも、肥大化した設定ファイルを人間様が手で整理なんてできるわけがない。  
そう、そこで登場するのが——**GPT君**だ。  人間が夜更かしして迷走するかわりに、  GPT君が冷静に構成を整えてくれた。  
（たぶん私より理性的だったと思う）

この **dotvim** は、そうして生まれた。  軽量なターミナルの中で、Vimを“自分の理想のIDE”に育て上げるための最小構成。  
**2つの設定ファイル**と**2本のスクリプト**だけで、  PHP と Kotlin に対応した再現可能なLSP環境を構築できる。

> （心の声）  
> 自分の環境でスクリプト動かして検証してないのは……秘密。  
> でも理論上は完璧だから、動く。たぶん。

---

### 🎯 コンセプト

*「理解しながら強くなる」開発環境。*  

dotvim は「設定を覚えるためのVim」ではなく、  
触って学び、動かして理解するためのVim環境である。  
依存も最小、構成も明快。  
Vimを「使う」だけでなく「作る」感覚を得られるよう設計している。

---

## ⚙️ 構成概要

.vimrc              Vim本体の設定
coc-settings.json   LSP（coc.nvim）の設定
install.sh          初期構築スクリプト
update-config.sh    設定変更を既存環境へ反映するスクリプト

全て合わせても1MB未満。  
初期導入からLSPセットアップまでを自動で完結させる。

---

## 🚀 セットアップ手順

### 1. リポジトリを取得

```bash
git clone https://github.com/Sina-TehraniFard/dotvim.git
cd dotvim
```

2. 実行権限を付与

```bash
chmod +x install.sh update-config.sh
```

3. 環境構築を実行

```bash
./install.sh
```

これにより以下が自動的に実行される：
- .vimrc と coc-settings.json の配置
- vim-plug（プラグインマネージャ）の導入
- Node.js の存在確認と自動インストール（未導入時）
- PHP / Kotlin 用 LSP サーバ（Intelephense / Kotlin Language Server）の導入
- coc.nvim のプラグイン自動インストール

⸻

## 🔁 設定の反映（既存環境）

.vimrc または coc-settings.json を更新した場合は、以下のコマンドで既存環境に再反映できる。

```bash
./update-config.sh
```

- 現行設定を backups/ に自動バックアップ
- 最新設定をホームディレクトリへ反映
- Vim起動中であれば :CocRestart で即時反映可能

⸻

## 🧩 主な機能

| 機能 | 操作 | 説明 | 使い方 |
|------|------|------|--------|
| **自動補完** | 自動 / `Ctrl + Space` | 入力中に候補が自動的に表示される | 変数・関数・メソッドを入力すると自動で候補が出現。`Ctrl + Space` で手動呼び出しも可能。 |
| **定義ジャンプ** | `gd` | 変数や関数の定義元へジャンプ | カーソルを変数・関数名の上に置き、`gd` を押す。定義先へ移動。`Ctrl + o` で元に戻れる。 |
| **型定義ジャンプ** | `gy` | 変数や関数の型定義へ移動 | 型情報を参照したい変数上で `gy`。主にKotlinで型確認に使う。 |
| **実装ジャンプ** | `gi` | インターフェイスの実装先へ移動 | インターフェイスや抽象メソッド上で `gi`。具象クラスの実装箇所へ移動。 |
| **参照検索** | `gr` | シンボルを参照している箇所を一覧表示 | カーソルを変数・関数名の上に置き、`gr`。下部に参照一覧が出る。`Enter` でその箇所へジャンプ。 |
| **ドキュメント表示** | `K` | 関数・クラス・変数の説明をポップアップ表示 | カーソルをシンボル上に置き、`K` を押す。型・Docコメント・引数情報を即座に確認。 |
| **シグネチャヘルプ** | 自動 | 関数呼び出し時に引数情報を表示 | 関数名を入力し `(` を打つと、引数の型・順番・デフォルト値などがポップアップで表示される。 |
| **診断メッセージ表示** | `:CocDiagnostics` | ファイル全体のエラー・警告一覧を表示 | コマンドモードで `:CocDiagnostics`。エラー箇所を選択して `Enter` でその位置へ移動。 |
| **エラー位置ジャンプ** | `[g` / `]g` | 前後の診断（エラー・警告）へ移動 | `[g` で前のエラー、`]g` で次のエラーへ。コードレビュー時に便利。 |
| **コードフォーマット** | `<leader>f` / 自動 | コード整形を実行 | ノーマルモードで `<Space>f`（または `\f`）を押す。保存時に自動整形される設定も可能。 |
| **コードアクション** | `<leader>a` | Quick Fix / リファクタ提案を表示 | カーソルを警告やコード上に置き `<Space>a`。修正候補（import補完、変数名変更など）が出現。 |
| **リネーム** | `<leader>rn` | シンボル名を安全に一括変更 | カーソルを変数名上に置き `<Space>rn`。新しい名前を入力し `Enter`。同一スコープ全てに反映。 |
| **シンボルアウトライン** | `:CocOutline` | クラス・関数構造をツリー表示 | コマンドモードで `:CocOutline`。別ウィンドウにファイル構造を表示し、クリックでジャンプ。 |
| **シンボル検索（ワークスペース）** | `:CocList symbols` | プロジェクト全体から関数・変数を検索 | コマンドモードで実行。検索ボックスが出現し、曖昧一致で関数名を絞り込み可能。 |
| **ファイル検索** | `:CocList files` | プロジェクト内のファイルを検索・開く | コマンドモードで実行。ファイル名を入力し `Enter` で開く。 |
| **バッファ管理** | `:CocList buffers` | 開いているファイル一覧を切り替え | 開いている全バッファを一覧表示。`Enter` で即切り替え。 |
| **拡張管理** | `:CocList extensions` | coc.nvim の拡張を一覧管理 | インストール済みLSP拡張（例: coc-php, coc-kotlin）を確認・更新・削除可能。 |
| **LSP情報確認** | `:CocInfo` | 現在動作中のLSP情報を表示 | 言語サーバが正しく動作しているか確認。ログ・プロセスIDなどを表示。 |
| **サーバ再起動** | `:CocRestart` | LSPサーバを再起動 | 設定変更後に必要。特に `coc-settings.json` 変更時に使用。 |

---

### 🧩 使い方補足

- **`<leader>`キー** は Vim のユーザー定義リーダーキー。  
  デフォルトでは `\` ですが、`.vimrc` で次のように設定するのが一般的です：  
  ```vim
  let mapleader=" "
  ```
これにより <leader>f は実際には Space + f を意味します。

⸻

## 📁 ディレクトリ構成

```bash
dotvim/
├── .vimrc
├── coc-settings.json
├── install.sh
├── update-config.sh
├── .gitignore
└── backups/
```
⸻

## 背景思想

開発でvim使ってたら格好いいなぁ

⸻

📜 License

MIT License
© 2025 Sina Tehrani Fard

